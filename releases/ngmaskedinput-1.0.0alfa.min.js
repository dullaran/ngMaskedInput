var ngMaskedInput=angular.module("ngMaskedInput",["ngMaskedInputServices"]);ngMaskedInput.directive("mask",["MaskedInput",function(a){"use strict";return{require:"?ngModel",scope:!1,link:function(b,c,d,e){e&&(c.bind("blur",function(){e.$viewValue&&b.$apply(-1===e.$viewValue.indexOf("_")?function(){b[d.ngModel]=c.val()}:function(){c.val("")})}),c.on("keydown",function(b){8===b.which?a.userOperation=8:46===b.which&&(a.userOperation=46)}),e.$parsers.unshift(function(b){return b&&(b=a.getNewViewValue(b,c,d,e)),b}))}}}]);
function MaskedInputClass(){"use strict";this.validChars=["A","9","*"],this.findFirstIndex=function(a){var b=[a.indexOf("A"),a.indexOf("9"),a.indexOf("*")].sort(),c=b.lastIndexOf(-1);return-1!==c?b[c+1]:b[0]},this.findLastIndex=function(a){var b=[a.lastIndexOf("A"),a.lastIndexOf("9"),a.lastIndexOf("*")].sort().reverse();return b[0]},this.getViewValueAfterOperation=function(a,b){return-1===this.validChars.indexOf(b.mask[this.cursor])&&(46===this.userOperation?(this.flux=2,a=a.substring(0,this.cursor)+a.substring(this.cursor+this.findFirstIndex(b.mask.substring(this.cursor)))):a=a.substring(0,this.findLastIndex(b.mask.substring(0,this.cursor)))+a.substring(this.cursor)),8===this.userOperation&&(this.flux=3),this.userOperation=void 0,a},this.setcursor=function(a,b,c){switch(this.flux){case 0:a[0].selectionStart=this.cursor-1;break;case 1:a[0].selectionStart=this.findFirstIndex(b.mask)+1;break;case 2:a[0].selectionStart=this.cursor;break;case 3:a[0].selectionStart=this.findLastIndex(b.mask.substring(0,this.cursor+1)),"_"!==c[a[0].selectionStart]&&a[0].selectionStart++;break;default:if(void 0===b.mask[this.cursor])a[0].selectionStart=this.cursor;else if(-1===this.validChars.indexOf(b.mask[this.cursor])){var d=this.cursor+this.findFirstIndex(b.mask.substring(this.cursor));a[0].selectionStart="_"!==c[d]&&void 0!==c[d]?d+1:d}else a[0].selectionStart=-1===this.validChars.indexOf(b.mask[this.cursor-1])&&void 0!==c[this.cursor]?this.cursor+1:this.cursor}this.flux=void 0,a[0].selectionEnd=a[0].selectionStart},this.getNewViewValue=function(a,b,c,d){var e;this.cursor=b[0].selectionStart;var f=c.mask.replace(new RegExp("[A9*]","g"),"_");1===a.length&&(this.flux=1),void 0!==this.userOperation&&(a=this.getViewValueAfterOperation(a,c));var g=a.replace(/[\W_]/gi,"");e=f;for(var h=0;h<g.length;h++){if("9"===c.mask[e.indexOf("_")]){if(!Boolean(parseInt(g[h]))){this.flux=0;continue}}else if("A"===c.mask[e.indexOf("_")]&&Boolean(parseInt(g[h]))){this.flux=0;continue}e=e.replace("_",g[h])}return e===f?(b.val(""),d.$viewValue=""):(b.val(e),this.setcursor(b,c,e),d.$viewValue=e),""}}var ngMaskedInputServices=angular.module("ngMaskedInputServices",[]);ngMaskedInputServices.factory("MaskedInput",function(){"use strict";return new MaskedInputClass});